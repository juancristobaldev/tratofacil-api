# ------------------------------------------------------
# THIS FILE WAS AUTOMATICALLY GENERATED (DO NOT MODIFY)
# ------------------------------------------------------

type AuthType {
  """Token JWT para sesiones autorizadas"""
  accessToken: String!

  """Información del usuario autenticado"""
  user: User!
}

type BankAccount {
  accountNumber: String!
  accountType: String!
  bankName: String!
  createdAt: DateTime!
  email: String
  id: Int!
  providerId: Int!
  rut: String
  updatedAt: DateTime!
}

input BankAccountInput {
  accountNumber: String!
  accountType: String!
  bankName: String!
  email: String
  rut: String
}

type Category {
  description: String
  id: Int!
  name: String!
  parentId: Int

  """Servicios asociados a esta categoría"""
  services: [Service]
  slug: String!
}

input CreateCategoryInput {
  description: String
  name: String!
  parentId: Int
  slug: String!
}

input CreateOrderInput {
  serviceProviderId: Int!
  total: Float!
  wcOrderId: Int
  wcOrderKey: String
}

input CreateServiceInput {
  categoryId: Int
  description: String
  hasHomeVisit: Boolean!
  name: String!
  price: Int!
  slug: String!
}

input CredentialsInput {
  email: String!
  password: String!
}

"""
A date-time string at UTC, such as 2019-12-03T09:54:33Z, compliant with the date-time format.
"""
scalar DateTime

input IdentityInput {
  company: String
  firstName: String!
  lastName: String!
  phone: String!
  rut: String!
}

input LoginInput {
  email: String!
  password: String!
}

type Mutation {
  """Confirma el código y crea el perfil de usuario + proveedor"""
  confirmEmailAndCreateUser(code: String!, credentials: CredentialsInput!, identity: IdentityInput!): AuthType!
  confirmPayment(token: String!): Order!
  createCategory(input: CreateCategoryInput!): Category!
  createOrder(input: CreateOrderInput!): Order!
  createService(input: CreateServiceInput!): ServiceProvider!
  deleteCategory(id: Int!): Category!
  deleteService(id: Int!): Boolean!

  """Verifica disponibilidad de email y envía código de validación"""
  findCredentialsAfterSendEmail(input: CredentialsInput!): Boolean!
  initiatePayment(orderId: Int!, returnUrl: String!): WebpayResponse!

  """Inicia sesión y retorna el token con la info del usuario"""
  login(loginInput: LoginInput!): AuthType!

  """Registra un usuario nuevo (Cliente por defecto)"""
  register(input: RegisterUserInput!): AuthType!
  registerProvider(input: UpdateProviderInput!): Provider!
  updateBank(input: BankAccountInput!, providerId: Int!): BankAccount!
  updateCategory(id: Int!, input: UpdateCategoryInput!): Category!
  updateOrderStatus(orderId: Int!, providerId: Int!, status: OrderStatus!): Order!
  updateProvider(id: Int!, input: UpdateProviderInput!): Provider!
  updateService(id: Int!, input: UpdateServiceInput!): ServiceProvider!
  updateUser(input: UpdateUserInput!): User!
}

type Order {
  """Cliente que realizó la orden"""
  client: User!
  clientId: Int!
  createdAt: DateTime!
  id: Int!
  payment: Payment
  review: ProviderReview

  """Servicio específico contratado"""
  serviceProvider: ServiceProvider
  serviceProviderId: Int
  status: OrderStatus!
  total: Float!
  updatedAt: DateTime!
  wcOrderId: Int
  wcOrderKey: String
}

"""Estado de una orden"""
enum OrderStatus {
  CANCELLED
  COMPLETED
  FAILED
  PENDING
  PROCESSING
  SUCCESS
}

type Payment {
  amount: Float!
  createdAt: DateTime!
  id: Int!

  """Orden asociada a este pago"""
  order: Order!
  orderId: Int!
  provider: PaymentProvider!
  status: PaymentStatus!
  transactionId: String
  updatedAt: DateTime!
}

enum PaymentProvider {
  MERCADOPAGO
  WEBPAY
}

enum PaymentStatus {
  CONFIRMED
  FAILED
  INITIATED
}

type Provider {
  bank: BankAccount
  bio: String
  certificates: [ProviderCertificate]
  createdAt: DateTime!
  id: Int!
  location: String
  logoUrl: String
  name: String!
  phone: String
  reviews: [ProviderReview]
  services: [ServiceProvider]
  slug: String!
  updatedAt: DateTime!
  user: User
  userId: Int!
  wcCategoryId: Int
}

type ProviderCertificate {
  createdAt: DateTime!
  fileUrl: String!
  id: Int!
  institution: String
  providerId: Int!
  title: String!
  verified: Boolean!
  year: Int
}

type ProviderReview {
  client: User!
  clientId: Int!
  comment: String
  createdAt: DateTime!
  id: Int!
  order: Order
  orderId: Int
  providerId: Int!
  rating: Int!
}

type Query {
  categories: [Category!]!
  category(id: Int!): Category!
  getOrdersByProvider(providerId: Int!): [Order!]!
  getServicesProvider(providerId: Int!): [Service!]!
  mainCategories: [Category!]!
  me: User!
  myProvider: Provider
  myServices: [Service!]!
  provider(id: Int!): Provider
  providers: [Provider!]!
  publicProfile(userId: Int!): User
  serviceDetail(providerId: Int!, serviceId: Int!): ServiceDetail!
  servicesByCategory(categorySlug: String!): [ServiceByCategory!]!
  subCategories: [Category!]!
  user(id: Int!): User
  users: [User!]!
}

input RegisterUserInput {
  displayName: String
  email: String!
  password: String!
  role: Role! = CLIENT
  username: String
}

"""Roles de usuario permitidos en la aplicación"""
enum Role {
  ADMIN
  CLIENT
  PROVIDER
}

type Service {
  category: Category
  categoryId: Int
  description: String
  id: Int!
  name: String!
  serviceProviders: [ServiceProvider]
  slug: String!
}

type ServiceByCategory {
  id: Int!
  name: String!
  providers: [ServiceProvider!]!
  slug: String!
}

type ServiceDetail {
  category: Category
  categoryId: Int
  commission: Float
  description: String
  hasHomeVisit: Boolean
  id: Int!
  name: String!
  netAmount: Float
  price: Float
  provider: Provider
  serviceProviders: [ServiceProvider]
  slug: String!
}

type ServiceProvider {
  commission: Float
  description: String
  hasHomeVisit: Boolean!
  id: Int!
  netAmount: Float
  orders: [Order]
  price: Float
  provider: Provider
  providerId: Int!
  service: Service
  serviceId: Int!
  slug: String!
}

input UpdateCategoryInput {
  description: String
  id: Int!
  name: String
  parentId: Int
  slug: String
}

input UpdateProviderInput {
  bank: BankAccountInput
  bio: String
  id: Int!
  location: String
  logoUrl: String
  name: String!
  phone: String
  rut: String!
}

input UpdateServiceInput {
  categoryId: Int
  description: String
  id: Int!
  name: String
  price: Int!
}

input UpdateUserInput {
  displayName: String
  email: String
  id: Int!
  nicename: String
  url: String
}

type User {
  activationKey: String!
  displayName: String!
  email: String!
  id: Int!
  nicename: String!
  orders: [Order]
  provider: Provider
  registered: DateTime!
  reviews: [ProviderReview]
  role: Role
  status: Int!
  url: String!
  username: String!
}

type WebpayResponse {
  token: String!
  url: String!
}