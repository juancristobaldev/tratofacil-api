# ------------------------------------------------------
# THIS FILE WAS AUTOMATICALLY GENERATED (DO NOT MODIFY)
# ------------------------------------------------------

type AuthType {
  """Token JWT para sesiones autorizadas"""
  accessToken: String!

  """Información del usuario autenticado"""
  user: User!
}

type BankAccount {
  accountNumber: String!
  accountType: String!
  bankName: String!
  createdAt: DateTime!
  email: String
  id: Int!
  providerId: Int!
  rut: String
  updatedAt: DateTime!
}

input BankAccountInput {
  accountNumber: String!
  accountType: String!
  bankName: String!
  email: String
  rut: String
}

type Category {
  description: String
  id: Int!
  imageUrl: String
  name: String!
  parentId: Int

  """Servicios asociados a esta categoría"""
  services: [Service]
  slug: String!
}

type CategoryProduct {
  """Lista de subcategorías pertenecientes a esta categoría"""
  children: [CategoryProduct]
  description: String
  id: Int!
  name: String!

  """Categoría de nivel superior"""
  parent: CategoryProduct
  parentId: Int
  slug: String!
}

input CreateCategoryInput {
  description: String
  imageUrl: String
  name: String!
  parentId: Int
  slug: String!
}

input CreateCategoryProductInput {
  description: String
  name: String!
  parentId: Int
  slug: String!
}

input CreateCertificateInput {
  fileUrl: String!
  institution: String
  title: String!
  year: Int
}

input CreateHobbyInput {
  name: String!
  providerId: Int!
}

input CreateOrderInput {
  serviceProviderId: Int!
  total: Float!
  wcOrderId: Int
  wcOrderKey: String
}

input CreateProductInput {
  categoryProductId: Int!
  description: String
  imageUrl: String
  name: String!
  price: Float!
  providerId: Int!
  slug: String!

  """Debe enviarse como un JSON string (ej: "{"color": "rojo"}")"""
  specifications: String
  stock: Int! = 0
}

input CreateProviderInput {
  bank: BankAccountInput
  company: String
  location: String
  logoUrl: String
  name: String!
  phone: String
  rut: String!
}

input CreateReviewInput {
  comment: String
  orderId: Int!
  providerId: Int!
  rating: Int!
}

input CreateServiceInput {
  categoryId: Int
  city: String
  description: String
  hasHomeVisit: Boolean!
  price: Int!
  slug: String!
}

input CredentialsInput {
  email: String!
  password: String!
}

"""
A date-time string at UTC, such as 2019-12-03T09:54:33Z, compliant with the date-time format.
"""
scalar DateTime

input DeleteHobbyInput {
  id: Int!
}

type Hobby {
  id: Int!
  name: String!
}

input IdentityInput {
  company: String
  firstName: String!
  lastName: String!
  phone: String!
  rut: String!
}

input LoginInput {
  email: String!
  password: String!
}

type Mutation {
  adminCreateCategory(description: String, imageUrl: String, name: String!, parentId: Int, slug: String!): Category!
  adminCreateService(categoryId: Int, description: String, imageUrl: String, name: String!, slug: String!): Service!
  adminDeleteCategory(id: Int!): Boolean!
  adminDeleteOrder(id: Int!): Boolean!
  adminDeleteReview(id: Int!): Boolean!
  adminDeleteService(id: Int!): Boolean!
  adminDeleteUser(id: Int!): Boolean!
  adminUpdateCategory(description: String, id: Int!, imageUrl: String, name: String, parentId: Int, slug: String): Category!
  adminUpdateOrderStatus(id: Int!, status: OrderStatus!): Order!
  adminUpdateService(categoryId: Int, description: String, id: Int!, imageUrl: String, name: String, slug: String): Service!
  adminUpdateUser(id: Int!, role: Role, status: Int): User!
  adminVerifyCertificate(id: Int!, verified: Boolean!): ProviderCertificate!
  approveCertificate(id: Int!): ProviderCertificate!

  """Confirma el código y crea el perfil de usuario + proveedor"""
  confirmEmailAndCreateUser(code: String!, credentials: CredentialsInput!, identity: IdentityInput!): AuthType!
  confirmPayment(token: String!): Order!
  createCategory(input: CreateCategoryInput!): Category!
  createCategoryProduct(createCategoryProductInput: CreateCategoryProductInput!): CategoryProduct!
  createCertificate(input: CreateCertificateInput!): ProviderCertificate!
  createHobby(createHobbyInput: CreateHobbyInput!): Hobby!
  createOrder(input: CreateOrderInput!): Order!
  createProduct(createProductInput: CreateProductInput!): Product!
  createReview(input: CreateReviewInput!): ProviderReview!
  createService(input: CreateServiceInput!): ServiceProvider!
  deleteCategory(id: Int!): Category!
  deleteCertificate(id: Int!): Boolean!
  deleteHobby(deleteHobbyInput: DeleteHobbyInput!): Hobby!
  deleteService(id: Int!): Boolean!

  """Verifica disponibilidad de email y envía código de validación"""
  findCredentialsAfterSendEmail(input: CredentialsInput!): Boolean!
  initiatePayment(orderId: Int!, returnUrl: String!): WebpayResponse!

  """Inicia sesión y retorna el token con la info del usuario"""
  login(loginInput: LoginInput!): AuthType!

  """Registra un usuario nuevo (Cliente por defecto)"""
  register(input: RegisterUserInput!): AuthType!
  registerProvider(input: CreateProviderInput!): Provider!
  rejectCertificate(id: Int!): ProviderCertificate!
  removeCategoryProduct(id: Int!): CategoryProduct!
  removeProduct(id: Int!): Product!
  updateBank(input: BankAccountInput!, providerId: Int!): BankAccount!
  updateCategory(id: Int!, input: UpdateCategoryInput!): Category!
  updateCategoryProduct(updateCategoryProductInput: UpdateCategoryProductInput!): CategoryProduct!
  updateCertificate(input: UpdateCertificateInput!): ProviderCertificate!
  updateOrderStatus(orderId: Int!, providerId: Int!, status: OrderStatus!): Order!
  updateProduct(updateProductInput: UpdateProductInput!): Product!
  updateProductStock(
    id: Int!

    """Cantidad a añadir (positivo) o quitar (negativo)"""
    quantity: Int!
  ): Product!
  updateProvider(id: Int!, input: UpdateProviderInput!): Provider!
  updateService(id: Int!, input: UpdateServiceInput!): ServiceProvider!
  updateUser(input: UpdateUserInput!): User!
}

type Order {
  """Cliente que realizó la orden"""
  client: User!
  clientId: Int!
  createdAt: DateTime!
  id: Int!
  payment: Payment
  review: ProviderReview

  """Servicio específico contratado"""
  serviceProvider: ServiceProvider
  serviceProviderId: Int
  status: OrderStatus!
  total: Float!
  updatedAt: DateTime!
  wcOrderId: Int
  wcOrderKey: String
}

"""Estado de una orden"""
enum OrderStatus {
  CANCELLED
  COMPLETED
  FAILED
  PENDING
  PROCESSING
  SUCCESS
}

type Payment {
  amount: Float!
  createdAt: DateTime!
  id: Int!

  """Orden asociada a este pago"""
  order: Order!
  orderId: Int!
  provider: PaymentProvider!
  status: PaymentStatus!
  transactionId: String
  updatedAt: DateTime!
}

enum PaymentProvider {
  MERCADOPAGO
  WEBPAY
}

enum PaymentStatus {
  CONFIRMED
  FAILED
  INITIATED
}

type Product {
  categoryProduct: CategoryProduct
  categoryProductId: Int!
  createdAt: DateTime!
  description: String
  id: Int!
  imageUrl: String
  name: String!
  price: Float!
  provider: Provider
  providerId: Int!
  slug: String!

  """Especificaciones del producto en formato JSON stringificado"""
  specifications: String
  stock: Int!
  updatedAt: DateTime!
}

type Provider {
  bank: BankAccount
  bio: String
  certificates: [ProviderCertificate]
  createdAt: DateTime!
  hobbys: [Hobby!]
  id: Int!
  location: String
  logoUrl: String
  name: String!
  phone: String
  reviews: [ProviderReview]
  services: [ServiceProvider]
  slug: String!
  updatedAt: DateTime!
  user: User
  userId: Int!
  wcCategoryId: Int
}

type ProviderCertificate {
  createdAt: DateTime!
  fileUrl: String!
  id: Int!
  institution: String
  provider: ProviderType
  providerId: Int!
  title: String!
  verified: Boolean!
  year: Int
}

type ProviderReview {
  client: User!
  clientId: Int!
  comment: String
  createdAt: DateTime!
  id: Int!
  order: Order
  orderId: Int
  providerId: Int!
  rating: Int!
}

type ProviderType {
  id: Int!
  name: String!
  user: User
}

type Query {
  """Listado de todas las categorías"""
  adminCategories: [Category!]!

  """Listado maestro de todas las órdenes del sistema"""
  adminOrders: [Order!]!

  """Obtener todos los proveedores con sus detalles"""
  adminProviders: [Provider!]!

  """Moderación de todas las reseñas"""
  adminReviews: [ProviderReview!]!

  """Listado de servicios base disponibles"""
  adminServices: [Service!]!

  """Obtener todos los usuarios (Clientes y Admins)"""
  adminUsers: [User!]!
  categories: [Category!]!
  categoriesProducts: [CategoryProduct!]!
  category(id: Int!): Category!
  categoryProduct(id: Int!): CategoryProduct!
  categoryProductBySlug(slug: String!): CategoryProduct!
  getCertificateById(id: Int!): ProviderCertificate!
  getCertificates(sortOrder: String = "desc", verified: Boolean): [ProviderCertificate!]!
  getMyCertificates: [ProviderCertificate!]!
  getOrdersByProvider(providerId: Int!): [Order!]!
  getServicesProvider(providerId: Int!): [Service!]!
  hobbies: [Hobby!]!
  hobbiesByProvider(providerId: Int!): [Hobby!]!
  hobby(id: Int!): Hobby!
  mainCategories: [Category!]!
  mainCategoryProducts: [CategoryProduct!]!
  me: User!
  myProvider: Provider
  myServices: [Service!]!
  product(id: Int!): Product!
  productBySlug(slug: String!): Product!
  products: [Product!]!
  productsByCategory(categoryProductId: Int!): [Product!]!
  productsByProvider(providerId: Int!): [Product!]!
  provider(id: Int!): Provider
  providers: [Provider!]!
  publicProfile(userId: Int!): User
  serviceDetail(providerId: Int!, serviceId: Int!): ServiceDetail!
  servicesByCategory(categorySlug: String!, city: String): [ServiceByCategory!]!
  subCategories: [Category!]!
  user(id: Int!): User
  users: [User!]!
}

input RegisterUserInput {
  displayName: String
  email: String!
  password: String!
  role: Role! = CLIENT
  username: String
}

"""Roles de usuario permitidos en la aplicación"""
enum Role {
  ADMIN
  CLIENT
  PROVIDER
}

type Service {
  category: Category
  categoryId: Int
  description: String
  id: Int!
  imageUrl: String
  name: String!
  serviceProviders: [ServiceProvider]
  slug: String!
}

type ServiceByCategory {
  id: Int!
  name: String!
  providers: [ServiceProvider!]!
  slug: String!
}

type ServiceDetail {
  category: Category
  categoryId: Int
  commission: Float
  description: String
  hasHomeVisit: Boolean
  id: Int!
  imageUrl: String
  name: String!
  netAmount: Float
  price: Float
  provider: Provider
  service: Service
  serviceProviders: [ServiceProvider]
  slug: String!
}

type ServiceProvider {
  cities: [ServiceProviderOnCity!]
  commission: Float
  description: String
  hasHomeVisit: Boolean!
  id: Int!
  netAmount: Float
  orders: [Order]
  price: Float
  provider: Provider
  providerId: Int!
  service: Service
  serviceId: Int!
  slug: String!
}

type ServiceProviderOnCity {
  city: String!
  serviceProviderId: Int!
}

input UpdateCategoryInput {
  description: String
  id: Int!
  imageUrl: String
  name: String
  parentId: Int
  slug: String
}

input UpdateCategoryProductInput {
  description: String
  id: Int!
  name: String
  parentId: Int
  slug: String
}

input UpdateCertificateInput {
  fileUrl: String
  id: Int!
  institution: String
  title: String
  year: Int
}

input UpdateProductInput {
  categoryProductId: Int
  description: String
  id: Int!
  imageUrl: String
  name: String
  price: Float
  slug: String
  specifications: String
  stock: Int
}

input UpdateProviderInput {
  bank: BankAccountInput
  company: String
  id: Int
  location: String
  logoUrl: String
  name: String
  phone: String
  rut: String
}

input UpdateServiceInput {
  categoryId: Int
  city: String
  description: String
  id: Int!
  name: String
  price: Int!
}

input UpdateUserInput {
  displayName: String
  email: String
  id: Int!
  nicename: String
  url: String
}

type User {
  activationKey: String!
  displayName: String!
  email: String!
  id: Int!
  nicename: String!
  orders: [Order]
  provider: Provider
  registered: DateTime!
  reviews: [ProviderReview]
  role: Role
  status: Int!
  url: String!
  username: String!
}

type WebpayResponse {
  token: String!
  url: String!
}